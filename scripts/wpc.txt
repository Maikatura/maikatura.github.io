# use powershell.exe Set-Wallpaper.ps1 -Image "<path to image>"

param ([string]$url="")

Function Set-WallPaper() {

Add-Type -TypeDefinition @" 
using System; 
using System.Runtime.InteropServices;

public class Params
{ 
    [DllImport("User32.dll",CharSet=CharSet.Unicode)] 
    public static extern int SystemParametersInfo (Int32 uAction, 
                                                   Int32 uParam, 
                                                   String lpvParam, 
                                                   Int32 fuWinIni);
}
"@ 

$SPI_SETDESKWALLPAPER = 0x0014
$UpdateIniFile = 0x01
$SendChangeEvent = 0x02

$fWinIni = $UpdateIniFile -bor $SendChangeEvent


$ret = [Params]::SystemParametersInfo($SPI_SETDESKWALLPAPER, 0, "$env:TEMP\pawned\content\background.png", $fWinIni)
}

curl $url -o "$env:TEMP\pawned\content\background.png"
Set-WallPaper
